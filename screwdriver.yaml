---
# Shared definition block
# This is where you would define any attributes that all your jobs will
# inherit. In our example, we state that all our Jobs will use the same Docker
# container for building in.
shared:
  # Docker image to use as the desired build container. This typically takes the
  # form of "repo_name". Alternatively, you can define the image as
  # "repo_name:tag_label".
  #
  # (Source: https://hub.docker.com/r/library/buildpack-deps/)
  image: buildpack-deps

parameters:
  deploy_api: "true"
  skip_test: [ "no", "yes" ]
  test_coverage:
    value: "80"
    description: "test coverage threshold percentage"

# Job definition block
# "main" is a default job that all pipelines have
jobs:
  # Jobs are defined by name.
  # All pipelines have "main" implicitly defined. The definitions in your
  # screwdriver.yaml file will override the implied defaults.
  commit:
    # Requires is a single job name or array of job names that will trigger the job to run.
    # Jobs defined with "requires: ~pr" are started by pull-request events.
    # Jobs defined with "requires: ~commit" are started by push events.
    # Jobs defined with "requires: ~sd@123:main" are started by job "main" from pipeline "123".
    # Jobs defined with "requires: main" are started after "main" is done.
    # Jobs defined with "requires: [deploy-west, deploy-east] are started after "deploy-west" and "deploy-east" are both done running successfully.
    requires: [~sd@1:second_job]
    # Steps is the list of commands to execute.
    steps:
      git_commit: |
        git clone https://github.com/sskimin4/quickstart-generic.git
        git --git-dir quickstart-generic/.git rev-parse --short HEAD
